# SSH é˜²æš´åŠ›ç ´è§£å®‰å…¨æŠ¥å‘Š

**ç”Ÿæˆæ—¶é—´**: 2026-02-17 17:34:02  
**æœåŠ¡å™¨**: ser120739360850

## ğŸ“Š å½“å‰é˜²æŠ¤çŠ¶æ€

### âœ… Fail2Ban è¿è¡ŒçŠ¶æ€
- **æœåŠ¡çŠ¶æ€**: ğŸŸ¢ è¿è¡Œä¸­ (Active since 15:50:30)
- **è¿è¡Œæ—¶é•¿**: 1å°æ—¶43åˆ†é’Ÿ
- **å†…å­˜å ç”¨**: 47.9M

### ğŸ›¡ï¸ SSH é˜²æŠ¤æ•ˆæœç»Ÿè®¡
| æŒ‡æ ‡ | æ•°å€¼ |
|------|------|
| **å½“å‰å°ç¦IPæ•°** | 32ä¸ª |
| **å†å²æ€»å°ç¦æ•°** | 33ä¸ª |
| **æ€»å¤±è´¥å°è¯•** | 1,717æ¬¡ |
| **å½“å‰å¤±è´¥å°è¯•** | 3æ¬¡ |

### ğŸ”’ å½“å‰é…ç½®å‚æ•°

#### SSH é˜²æŠ¤è§„åˆ™ (`[sshd]`)
```ini
enabled = true
port = 22,no
maxretry = 5          # 5æ¬¡å¤±è´¥åå°ç¦
findtime = 300        # 5åˆ†é’Ÿå†…
bantime = 86400       # å°ç¦24å°æ—¶
logpath = /var/log/secure
```

#### å…¶ä»–é˜²æŠ¤è§„åˆ™
- **FTPé˜²æŠ¤**: å·²å¯ç”¨ (ç«¯å£21)
- **Nginxæ‰«æé˜²æŠ¤**: å·²å¯ç”¨ (ç«¯å£80,443)

## ğŸš¨ å·²å°ç¦çš„æ”»å‡»IP (éƒ¨åˆ†)

```
112.163.119.199  121.227.31.82   134.209.195.241
143.20.185.252   159.223.84.137  161.35.88.147
165.22.194.103   171.231.181.209 172.104.242.184
174.138.4.160    188.166.107.166 64.225.74.47
80.94.92.186     87.98.166.118   92.118.39.95
... (å…±32ä¸ªIP)
```

## ğŸ’¡ ä¼˜åŒ–å»ºè®®

### 1. åŠ å¼ºSSHé…ç½® (æ¨è)
```bash
# ç¼–è¾‘ SSH é…ç½®
sudo vim /etc/ssh/sshd_config

# å»ºè®®ä¿®æ”¹:
PermitRootLogin no              # ç¦æ­¢rootç›´æ¥ç™»å½•
PasswordAuthentication no       # ç¦ç”¨å¯†ç ç™»å½•(ä»…å¯†é’¥)
MaxAuthTries 3                  # æœ€å¤§è®¤è¯å°è¯•æ¬¡æ•°
ClientAliveInterval 300         # 5åˆ†é’Ÿæ— æ´»åŠ¨æ–­å¼€
ClientAliveCountMax 2           # æœ€å¤§ç©ºé—²æ¬¡æ•°
Port 2222                       # ä¿®æ”¹é»˜è®¤ç«¯å£(å¯é€‰)
```

### 2. åŠ å¼ºFail2Banè§„åˆ™ (å¯é€‰)
```bash
# ç¼–è¾‘é…ç½®
sudo vim /etc/fail2ban/jail.local

# æ›´ä¸¥æ ¼çš„è§„åˆ™:
[sshd]
maxretry = 3          # 3æ¬¡å¤±è´¥å³å°ç¦(å½“å‰5æ¬¡)
findtime = 600        # 10åˆ†é’Ÿå†…(å½“å‰5åˆ†é’Ÿ)
bantime = 604800      # å°ç¦7å¤©(å½“å‰24å°æ—¶)
```

### 3. å¯ç”¨å¯†é’¥è®¤è¯
```bash
# ç”ŸæˆSSHå¯†é’¥å¯¹
ssh-keygen -t ed25519 -C "your_email@example.com"

# å¤åˆ¶å…¬é’¥åˆ°æœåŠ¡å™¨
ssh-copy-id -i ~/.ssh/id_ed25519.pub user@server

# ç„¶åç¦ç”¨å¯†ç ç™»å½•
```

### 4. å®‰è£…é¢å¤–é˜²æŠ¤å·¥å…· (å¯é€‰)
```bash
# DenyHosts - å¦ä¸€ä¸ªSSHé˜²æŠ¤å·¥å…·
sudo yum install denyhosts

# SSHGuard - è½»é‡çº§é˜²æŠ¤
sudo yum install sshguard
```

## ğŸ“ˆ ç›‘æ§å‘½ä»¤

### æŸ¥çœ‹å®æ—¶çŠ¶æ€
```bash
# æŸ¥çœ‹æ‰€æœ‰jailçŠ¶æ€
sudo fail2ban-client status

# æŸ¥çœ‹SSHè¯¦ç»†çŠ¶æ€
sudo fail2ban-client status sshd

# æŸ¥çœ‹å®æ—¶æ—¥å¿—
sudo tail -f /var/log/fail2ban.log

# æŸ¥çœ‹æœ€è¿‘å°ç¦è®°å½•
sudo journalctl -u fail2ban -n 50 --no-pager
```

### æ‰‹åŠ¨æ“ä½œ
```bash
# æ‰‹åŠ¨å°ç¦IP
sudo fail2ban-client set sshd banip 1.2.3.4

# æ‰‹åŠ¨è§£å°IP
sudo fail2ban-client set sshd unbanip 1.2.3.4

# é‡æ–°åŠ è½½é…ç½®
sudo fail2ban-client reload
```

## ğŸ¯ å½“å‰è¯„ä¼°

| é¡¹ç›® | çŠ¶æ€ | è¯„åˆ† |
|------|------|------|
| Fail2Banè¿è¡Œ | âœ… æ­£å¸¸ | â­â­â­â­â­ |
| æ‹¦æˆªæ•ˆæœ | âœ… ä¼˜ç§€ (å·²æ‹¦æˆª1700+æ¬¡æ”»å‡») | â­â­â­â­â­ |
| é…ç½®åˆç†æ€§ | âœ… è‰¯å¥½ | â­â­â­â­ |
| SSHå®‰å…¨æ€§ | âš ï¸ å¯ä¼˜åŒ– | â­â­â­ |

## ğŸ” å®‰å…¨å»ºè®®ä¼˜å…ˆçº§

1. **é«˜ä¼˜å…ˆçº§** (ç«‹å³æ‰§è¡Œ):
   - âœ… Fail2Banå·²å¯ç”¨ - å·²å®Œæˆ
   - ğŸ”² ç¦ç”¨rootç›´æ¥ç™»å½•
   - ğŸ”² å¯ç”¨SSHå¯†é’¥è®¤è¯

2. **ä¸­ä¼˜å…ˆçº§** (å»ºè®®æ‰§è¡Œ):
   - ğŸ”² ä¿®æ”¹SSHé»˜è®¤ç«¯å£
   - ğŸ”² åŠ å¼ºFail2Banè§„åˆ™(3æ¬¡å¤±è´¥å³å°ç¦)
   - ğŸ”² ç¦ç”¨å¯†ç ç™»å½•

3. **ä½ä¼˜å…ˆçº§** (å¯é€‰):
   - ğŸ”² å®‰è£…é¢å¤–é˜²æŠ¤å·¥å…·
   - ğŸ”² é…ç½®IPç™½åå•
   - ğŸ”² å¯ç”¨åŒå› ç´ è®¤è¯(2FA)

## ğŸ“ æ€»ç»“

**å½“å‰çŠ¶æ€**: ä½ çš„æœåŠ¡å™¨å·²ç»æœ‰äº†åŸºæœ¬ä½†æœ‰æ•ˆçš„SSHé˜²æŠ¤æªæ–½ã€‚Fail2Banæ­£åœ¨æ­£å¸¸å·¥ä½œï¼Œå·²æˆåŠŸæ‹¦æˆªäº†å¤§é‡æš´åŠ›ç ´è§£æ”»å‡»ã€‚

**é˜²æŠ¤æ•ˆæœ**: ä»ç»Ÿè®¡æ•°æ®çœ‹ï¼Œç³»ç»Ÿå·²ç»é˜»æ­¢äº†1700å¤šæ¬¡å¤±è´¥çš„ç™»å½•å°è¯•ï¼Œå°ç¦äº†32ä¸ªæ¶æ„IPï¼Œé˜²æŠ¤æ•ˆæœæ˜¾è‘—ã€‚

**æ”¹è¿›ç©ºé—´**: å»ºè®®è¿›ä¸€æ­¥åŠ å¼ºSSHé…ç½®æœ¬èº«çš„å®‰å…¨æ€§ï¼Œå¦‚ç¦ç”¨rootç™»å½•ã€å¯ç”¨å¯†é’¥è®¤è¯ç­‰ï¼Œå¯ä»¥ä»æ ¹æœ¬ä¸Šæå‡å®‰å…¨ç­‰çº§ã€‚
